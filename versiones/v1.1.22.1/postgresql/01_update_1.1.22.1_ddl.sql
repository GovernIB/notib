-- Refactoritzacio callbacks
CREATE TABLE NOT_CALLBACK (
    ID INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    USUARI_CODI VARCHAR(64) NOT NULL,
    NOTIFICACIO_ID numeric NOT NULL,
    ENVIAMENT_ID numeric NOT NULL,
    DATA TIMESTAMP(6) WITHOUT TIME ZONE,
    ERROR BOOLEAN DEFAULT FALSE NOT NULL,
    ERROR_DESC VARCHAR(2048),
    ESTAT VARCHAR(10),
    INTENTS INTEGER DEFAULT 0 NOT NULL,
    CONSTRAINT NOT_CALLBACK_PK PRIMARY KEY (ID),
    UNIQUE (ENVIAMENT_ID));

ALTER TABLE not_notificacio_env ADD callback_error BOOLEAN DEFAULT FALSE NOT NULL;
ALTER TABLE not_notificacio_env_table ADD callback_error BOOLEAN DEFAULT FALSE NOT NULL;

-- Refactoritzacio events
ALTER TABLE not_notificacio_event ADD intents numeric(10, 0) DEFAULT 1 NOT NULL;
ALTER TABLE not_notificacio_event ADD fi_reintents BOOLEAN DEFAULT FALSE;

